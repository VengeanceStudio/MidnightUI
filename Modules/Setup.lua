local MidnightUI = LibStub("AceAddon-3.0"):GetAddon("MidnightUI")
local Setup = MidnightUI:NewModule("Setup", "AceEvent-3.0")

local defaults = {
    profile = {
        hasCompletedSetup = false,
    }
}

-- Edit Mode preset strings for each resolution
local editModePresets = {
    ["4K"] = "YOUR_4K_EDIT_MODE_STRING_HERE",
    ["1440p"] = "2 50 0 0 0 7 7 UIParent -0.0 2.0 -1 ##$$%/&%'%)$+#,$ 0 1 0 8 2 MainActionBar 0.0 4.0 -1 ##$$%/&%'%(#,$ 0 2 0 8 2 MultiBarBottomLeft 0.0 4.0 -1 ##$$%/&%'%(#,$ 0 3 0 7 7 UIParent 35.4 114.0 -1 ##$$%/&%'%(#,# 0 4 0 8 6 MainActionBar -4.0 0.0 -1 ##$%%/&%'%(#,$ 0 5 0 6 8 MainActionBar 4.0 0.0 -1 ##$%%/&%'%(#,$ 0 6 0 7 7 UIParent 500.1 0.7 -1 ##$&%/&%'%(#,$ 0 7 0 7 7 UIParent 37.0 150.3 -1 ##$$%/&%'%(#,# 0 10 0 4 4 UIParent 569.0 -440.0 -1 ##$$&('% 0 11 0 7 7 UIParent 447.2 201.7 -1 ##$$&('%,# 0 12 1 7 7 UIParent 0.0 45.0 -1 ##$$&('% 1 -1 1 4 4 UIParent 0.0 0.0 -1 ##$#%# 2 -1 0 2 2 UIParent 0.0 0.0 -1 ##$#%* 3 0 0 3 3 UIParent 454.5 -224.7 -1 $#3* 3 1 0 4 4 UIParent 812.3 -321.4 -1 %#3* 3 2 0 7 7 UIParent 753.5 328.0 -1 %#&#3# 3 3 0 0 0 UIParent 789.7 -969.0 -1 '$(#)$-I.7/#1#3#5#6+7-7$ 3 4 1 0 2 CompactRaidFrameManager 0.0 -5.0 -1 ,#-#.#/#0#1#2(5#6-6$7-7$ 3 5 0 2 2 UIParent -1730.7 -893.0 -1 &#*$3# 3 6 1 5 5 UIParent 0.0 0.0 -1 -#.#/#4$5#6-6$7-7$ 3 7 1 4 4 UIParent 0.0 0.0 -1 3# 4 -1 0 0 0 UIParent 581.7 -1084.0 -1 # 5 -1 0 4 4 UIParent -380.0 -420.0 -1 # 6 0 0 2 2 UIParent -233.9 -25.5 -1 ##$#%#&.(()( 6 1 0 2 8 BuffFrame -15.0 -4.0 -1 ##$#%#'+(()(-$ 6 2 1 1 1 UIParent 0.0 -25.0 -1 ##$#%$&.(()(+#,-,$ 7 -1 0 4 4 UIParent 0.0 -280.8 -1 # 8 -1 0 6 6 UIParent 32.0 32.0 -1 #&$g%%&# 9 -1 1 7 7 UIParent 0.0 45.0 -1 # 10 -1 1 0 0 UIParent 16.0 -116.0 -1 # 11 -1 0 8 2 BagsBar -0.5 3.5 -1 # 12 -1 0 5 5 UIParent -2.0 8.3 -1 #7$#%% 13 -1 0 8 8 UIParent -5.2 3.4 -1 ##$#%%&# 14 -1 0 8 2 MicroMenuContainer 0.5 3.5 -1 ##$#%# 15 0 0 1 1 UIParent 8.4 -46.3 -1 # 15 1 0 1 1 UIParent 8.3 -67.7 -1 # 16 -1 1 5 5 UIParent 0.0 0.0 -1 #( 17 -1 1 1 1 UIParent 0.0 -100.0 -1 ## 18 -1 1 5 5 UIParent 0.0 0.0 -1 #- 19 -1 1 7 7 UIParent 0.0 0.0 -1 ## 20 0 0 4 4 UIParent 2.0 -244.1 -1 ##$7%$&&'+(-($)#+$,$-$ 20 1 0 7 7 UIParent 1.8 285.8 -1 ##$7%$&&'%(-($)#+$,$-$ 20 2 0 4 4 UIParent -1.7 -181.7 -1 ##$$%#&''#(-($)#+$,$-$ 20 3 0 7 7 UIParent 3.3 218.5 -1 #+$,$-%#&('#(-($)#*%+$,$-$.U 21 -1 1 7 7 UIParent -410.0 380.0 -1 ##$# 22 0 0 7 7 UIParent -960.0 1.0 -1 #,$+%#&('#(#)#*$+#,$ 22 1 0 7 7 UIParent 18.0 962.0 -1 &('()#*#+$ 22 2 1 1 1 UIParent 0.0 -270.0 -1 &('()#*#+$ 22 3 1 1 1 UIParent 0.0 -315.0 -1 &('()#*#+$ 23 -1 0 8 8 UIParent -5.3 76.2 -1 ##$#%#&7'U(#)U+$,.-&.(/A",
    ["1080p"] = "2 50 0 0 0 7 7 UIParent -0.0 2.0 -1 ##$$%/&$'%)$+#,$ 0 1 0 8 2 MainActionBar 0.0 4.0 -1 ##$$%/&%'%(#,$ 0 2 0 8 2 MultiBarBottomLeft 0.0 4.0 -1 ##$$%/&%'%(#,$ 0 3 0 7 7 UIParent 1.6 110.7 -1 ##$$%/&%'%(#,# 0 4 0 8 6 MainActionBar -4.0 0.0 -1 ##$%%/&$'%(#,$ 0 5 0 6 8 MainActionBar 4.0 0.0 -1 ##$%%/&$'%(#,$ 0 6 0 7 7 UIParent 431.7 1.5 -1 ##$&%/&$'%(#,$ 0 7 0 7 7 UIParent 1.1 147.9 -1 ##$$%/&%'%(#,# 0 10 0 4 4 UIParent 569.0 -440.0 -1 ##$$&('% 0 11 0 1 1 UIParent 459.0 -982.0 -1 ##$$&''%,# 0 12 1 7 7 UIParent 0.0 45.0 -1 ##$$&('% 1 -1 1 4 4 UIParent 0.0 0.0 -1 ##$#%# 2 -1 0 2 2 UIParent 0.0 0.0 -1 ##$#%* 3 0 0 3 3 UIParent 454.5 -224.7 -1 $#3* 3 1 0 4 4 UIParent 812.3 -321.4 -1 %#3* 3 2 0 7 7 UIParent 753.5 328.0 -1 %#&#3# 3 3 0 0 0 UIParent 789.7 -969.0 -1 '$(#)$-I.7/#1#3#5#6+7-7$ 3 4 1 0 2 CompactRaidFrameManager 0.0 -5.0 -1 ,#-#.#/#0#1#2(5#6-6$7-7$ 3 5 0 2 2 UIParent -1730.7 -893.0 -1 &#*$3# 3 6 1 5 5 UIParent 0.0 0.0 -1 -#.#/#4$5#6-6$7-7$ 3 7 1 4 4 UIParent 0.0 0.0 -1 3# 4 -1 0 0 0 UIParent 581.7 -1084.0 -1 # 5 -1 0 4 4 UIParent -380.0 -420.0 -1 # 6 0 0 2 2 UIParent -233.9 -25.5 -1 ##$#%#&.(')( 6 1 0 2 8 BuffFrame -15.0 -4.0 -1 ##$#%#'+(')(-$ 6 2 1 1 1 UIParent 0.0 -25.0 -1 ##$#%$&.(()(+#,-,$ 7 -1 0 4 4 UIParent 0.0 -280.8 -1 # 8 -1 0 6 6 UIParent 32.0 32.0 -1 #&$#%$&U 9 -1 1 7 7 UIParent 0.0 45.0 -1 # 10 -1 1 0 0 UIParent 16.0 -116.0 -1 # 11 -1 0 8 2 BagsBar -0.5 3.5 -1 # 12 -1 0 5 5 UIParent -2.0 -52.7 -1 #7$#%% 13 -1 0 8 8 UIParent -5.2 3.4 -1 ##$#%$&# 14 -1 0 8 2 MicroMenuContainer 0.5 3.5 -1 ##$#%# 15 0 0 1 1 UIParent 8.4 -46.3 -1 # 15 1 0 1 1 UIParent 8.3 -67.7 -1 # 16 -1 1 5 5 UIParent 0.0 0.0 -1 #( 17 -1 1 1 1 UIParent 0.0 -100.0 -1 ## 18 -1 1 5 5 UIParent 0.0 0.0 -1 #- 19 -1 1 7 7 UIParent 0.0 0.0 -1 ## 20 0 0 4 4 UIParent 2.0 -244.1 -1 ##$7%$&%'+(-($)#+$,$-$ 20 1 0 7 7 UIParent 0.8 250.8 -1 ##$7%$&%'%(-($)#+$,$-$ 20 2 0 4 4 UIParent -1.7 -181.7 -1 ##$$%#&&'#(-($)#+$,$-$ 20 3 0 7 7 UIParent -0.7 199.5 -1 #+$,$-%#&&'#(-($)#*%+$,$-$.U 21 -1 1 7 7 UIParent -410.0 380.0 -1 ##$# 22 0 0 7 7 UIParent -960.0 1.0 -1 #,$+%#&('#(#)#*$+#,$ 22 1 0 7 7 UIParent 18.0 962.0 -1 &('()#*#+$ 22 2 1 1 1 UIParent 0.0 -270.0 -1 &('()#*#+$ 22 3 1 1 1 UIParent 0.0 -315.0 -1 &('()#*#+$ 23 -1 0 8 8 UIParent -5.3 76.2 -1 ##$#%#&7'U(#)U+$,.-&.(/A",
}

-- MidnightUI preset strings for each resolution
local midnightUIPresets = {
    ["4K"] = "YOUR_4K_MIDNIGHTUI_STRING_HERE",
    ["1440p"] = "MUIV2:034F133900794A693D28CD274AA5FD445C224A192554E99450C5AAA2A4E816A5D8A54A7E514486A9EA1854CB447A4651D3A4728D826D02BEA9C23855EA1C14AD234AF08E28D14129CA42110F896AA240BAA88A3612C5478AA89102E124281E16A5E22551529949916E426127F0530A4305EAA814D55229F2943415E4AA50D55681E856514235962855C78A92C25AA2A4EA2D853A4B94E42E85EC457F89126230910E1316437A2CA5C9822E2B6D96AACF42190D715AE1555142794D11668BBA0DAADD547EAB0C17729C28212DA7EAB9A2E992EB946C172ADFA1349E527D254A4A132744858BE10851E1175A7927212A5C449309353E4C62559D9B4CA8A2AD710E157E32A116768589C9843AB7AC8809759A186E32A1B677393CAC9B44A9961BD57B01DFC9848A0ACF84452D64E14B888AC6E497CF1322C009FE0B274809FE0B273013FC174ED011FCD79B45EDCF1555C60F5889B4B925422F4A48A41044EDCF950ED825C0532A7A3E5C2FBF7C9E10014EF00952824F6026F8041D01CE62B1A84EC07746A2DD49880A6157989884A8031E9DAF46DC7AAC1FB54F27D0BC2113EA8047E7AB11B71EEB476DD0ED85958B281519E19AEC6D23E4DC64424546B8898825C233A1F66296E95D31615175CB8A08511131E5078FF2D686BA65454C58540C114D42D4891C56D69F5BA2D4891C16F2A235315C8C0915B5AACE25C2CB8A32365D00FF011CB37B749881B7E111606FD375D4EBFBB9257B02FC41EDCF55C3AA3CDC521BF1215318F0A4B6F95A1384A8B6043629D54EF0A9D10D57D4A401410D0C6A7BF93C21029C00274809700233014ED011E02C16750ED82548D34F858B911B7D3FB76445608353E162E446DFCF2DD913D8E05461D5C9FA3B38132A6A559D4B844FACAA7333787DD36109F04F45ADAA7389F0CD5C8B9CA7428DE02618938380A8D1CD51E31C21AA2D656C0298F83B80FFF73B0D18DEE66F666FD3BDA976CAD804FE37040298981DE63B60C07C77EC6D0C298B7A7D3FB7644560A04E44444BD5E6F19B353DA913396CD0D1F7A3B572D912A5F6E74A07EC12E02915B5AACE25C2CB2F9F2744150438D513FC97811A23F82F031525F82F038B8A5A55E712E1E597B388E6863A609720FDD4F6CE879310D596004FA976824F8D6EB8A2260D086A6050DBCBE70911E00438414A8013980970828E0067B1A81339AC5CE475A1F044A913396C736BAD654245ADAA7389F01A8976B818C1A7A256D5B944F8F873E559CC29BF7C9E0975228795DFF97012A586A3EF476BE5B26DF4FDDC923D814DC0400D47DF8FD6CA65DBE8FBB9252B021B0315F6DC12A2DA1218A876824F8D6EB8A2428D606A7BF93C21029C00274809FEEB4D6026F8041D01CE625151ABEA5C22FCD309346FC8843A91C3628C39C7B949943A91C3628891995051ABEA5C227C62559DD301BB04E6948A5A55E712E161DA73DA8ABC043815B5AACE25C29BEC0F5B48D0E1B7AD718E9AB72FEA440E2BCFD79A204AEDCF1555C60F5889B4B925422F4A48A4104445ADAA7389F0B227B0C15F860EC7039881CEDCFD146751D5C47084A8D3C47089884D26D46962B8666D8D7389F0930915B5AACE25E7C3F5F2CBE70911E0049F2025F80466824FD011E02CEA34315C92072CACF0A18C17F09D4CA8D3C470F1DD28192FE03B895251ABEA5C225A13317F960BE597CF1322C009FE0B274809FE0B273013FC174ED011FCD79B459D26869323A264BC80EF244A9D26860B2A4A24FE4CAC4F849F4CA8D3C47018C30DB8889850A789E1E2C32456D5B9C9843A4D0C07DDE51AD164428DE543455613C3513146E8460C291635119E1015F56762FD2444C5105316B596107522873515E866A2D4891C16A63DC7843A91C3CAEF7C388952451E3147953F01F46CA24EE4B0D0DA8B09F57CB89E00FF5454782A38B72C2AD808890F2391CAEF727858279162082762EB095127725853816E264A9DC86161DA734CA81339ACFCCE87932855E4117354F91340CF26EA440E0BADBD9850CF87EB09F04F4585A78273CBA226564C456B821075228795DFF97012A58A3C628E6AFA9481A8D65C45CE97A9403713A54EE4B0A602DDCC843A91C3C2B4E79850ADB941B71D70918952E32E5BF0D5DA88E0BFBE813A91C3426B2F26D4F3E17A02FC5351E1A9E0DCB2A8182374238694E9B5A2C63942D4891C567EE7C3C9842AF288396A138CC94140546BAE22E7CB54A09B8952ADB941B71D7091895227725853816E264A9DC86161DA734CA8ED9D0F836E3BE0224F824F8DBB6CC1576B2382FFFA06EA440E0BADBD9850CF87EB09D24F4585A76288E112E159548C11BA11434A9EAF3541883A91C3CAEF7C388952451E3147953F01F46CA25A7315395FA602DD4C943A91C39A0A743351EA440E0BD39E6342B5E606DD76C045264A8DBB6CC1576B2382FFFA06EA440E0BADBD9850CF87EB09F04F4585A76288E112E159548C11BA11432AA8E50521EA440E2BBFF3E1244A1579C41CD5F4290351ADB98A9C2F53816E264A9DC8614D05BA99097522878569CF31A15A73836E3BE02213A5C65DB6E0ABB511C17F7D0375228785D65E4CA8E7C3F504F8A7A2C253C1B965513146E8460CA9A0A3EF0951277258F99D0F2751AAC823E6A84D3026070151ADB98A9C2F53816E264A9DC8614D05BA99287522878569CF31A15A73836E3BE02213A5C65DB6E0ABB511C17F7D0375228785D65E4CA8E7C3F504E64F4585A76288E112E159548C11BA11430A3A13EB0851277258F99D0F2751AAC823E6A8F227809E4D546BAE22E7CB54A09B895227725853816E66429DC86161DA734CA8D6DCA0DB0EB8C844A971972DF86A6D44F05FDF409DC861A1B51713EAF9703D01FEA9A8F054706E59D4A0071FEE2621EA440E6B2AD0CD44A913392C4C7B8E0975228795DFF97012A58A3C628E2A7F02E8D9449DC861A1B51713EAF9703D01FEA9A8F054706E59548C11BA11432AC8CB167C0951277258F99D0F2751AAC823E6A84D3026070151ADB98A9C2F53816E264A9DC8614D05BA99287522878569CF31A15A73836E3BE02213A5C65DB6E0ABB511C17F7D0375228785D65E4CA8E7C3F504F8A7A2C25331C47089F02C2AC608DD882165F2E5901075228795DFF97012A58A3C628E6AFA9481A8D65C45CE97A9403713A54EE4B0A602DDCC843A91C3C2B4E79850ADB941B71D70918952E32E5BF0D5DA88E0BFBE813A91C3426B2F26D4F3E17A82EE5351E1A91862B84478161563846EC49052DB590B27449DC861E5773E9C44A9228F98A39A3E6520AA355791F3652AD0CD44A91339ACA9403733A14EE4B030ED3926546B6ED06D075C64A2D4B8CB167CB53622F8AF6FA04EE4B0D0DA8B09F57CB89EC0FCA9A8F0540C315C223C8B8A3142376248C9F8B12E9C84A81339ACFCCE87932855E41173D42618938380A8D65C45CE97A9403713A54EE4B0A602DDCC843A91C3C2B4E79850ADB941B71D70918952E32E5BF0D5DA88E0BFBE813A91C3426B2F26D4F3E17A02F3A7A2C253C1B965513146E8460CA944C42621EA440E2BBFF3E1244A1579C41CD5F4290351ADB98A9C2F53816E264A9DC8614D05BA99097522878569CF31A15A73836E3BE02213A5C65DB6E0ABB511C17F7D0375228785D65E4CA8E7C3F504F8A7A2C253C1B965513146E8460C2918D3B84C883A91C3CAEF7C388952451E3147357DCA40546BAE22E7CB54A09B895227725853816E66429DC86161DA734CA8D6DCA0DB0EB8C844A971972DF86A6D44F05FDF409DC861A1B51713EAF9703D01FEA9A8F054706E59548C11BA1143CA646BE4901075228795DFF97012A58A3C628E6AFA9481A8D65C45CE97A9403713A54EE4B0A602DDCC843A91C3C2B4E79850ADB941B71D70918952E32E5BF0D5DA88E0BFBE813A91C3426B2F26D4F3E17A82EE5351E1A9E0DCB258D4FE5CC92F9F2744F504383546805351029C45EDCF950ED825C0CDD4198976B818016EA066312BC8CB167C09700315155E4D0C47C518A11B31A4A8FDB9A236F34364891408EF0F4BB5E66A09170A1F4203BE4CA87526D60531669DB725448013A2467EB44B90623EBE19F3FFFFA935E04B803F1EFFFF37E6C76411A484A8911FED12A498DD03C7FFFF9F5A03BE04F8E3F1FF376006022C0233216AE447BB042966F7F1C7FFFF536BC097007F3CFEFFDDDB6060117484A8911FED12A498660366F7FFFFD41AF025C01F8FFFBF1933D0B1080C84A8911FED12A498E677FAF8FF7F6A0DF812E08FC7FFFF3FBA008B45CDD79AD8900915157E12A26288E112E10951D709346FC8841ADD7045851AC1D4D98ABC0438B53F5754193F6025D2E69608BD282191421055E4081104FF15A06247580841E07F6A6FE52C6B47580813AA9DE053DBCBE709513DC17FE1D418C17FE15494E0BF7016759A188E8A314237624851911D31A408D28E1A89301C2E46807FAA2DC1A7D6DACBF24B4DF28085153E64B1A8D65C791673CA2F9F67428D5D0E838A1284A841AE8BAD70ADECC86212A98D446AB21FB0B0D956220D62E43C0951DB2CE6A4067D62344010F101F46CA20AF859AE080C06C3DBFC36FFF70FB0A8CDE09B8790486D245293FD8085CDB612691023E749882AE067B922301BD2F49D76E6C783DA66312715A301641D8B9AF8019F754E76644D89D4462285102F7226446DB398932A6B9B359936E4B28E2AE067B922787F4C3C60C0C459D460CB47961712A98D446AB21FB0B0D956220D62E43C095105FC2C5704F837E3DDFF8640476DB398931AB4293E4C5016B599E5CF8B50606547D690486D245208F1226742D4368B39A9C1CD4C9B05850154013FCB158119F307CC9D21359B59D48630B16E22B2238B6F0E25521B89D4643F6061B3AD441AC4C87912A2B659CC490D6E66DA2C280CA00AF859AE08F0376EC07C073A9CC56251E3C32456D5B94988BA4EA0794326D4FE5CE9805D82F453672BF212FC57801A1F26B1AACE4D42D4B58F22445D27D0BC2113EAF9703D41CAA25E54E3DC24445D27D0BC2113EAF9703D8199451561786E12A2AE1368DE9009F57CB89EA06351E117B784A8EB049A3764423D1FAE2730B0A87EF3899010759D40F3864CA8E7C3F504388B45EDCF1555C60F5889B4B925422F4A48A410448D6E8E1AE708516D29D3BDDF0F3C1030E066C3E381F9EED8DB7401AA9D32368FB47B63067E67C67CE0E60726CEDEA6C3A446375C5193060435309A604C0E026251F3B52636244A45456B22E6CF72A1FCF279420438651EE6EEF13BCCCE8C19C0FC0F8381BD8D21409052E661EE1EBFC3ECCC9801CCFF3018D8DB18020466CA3CCCDDE377989D193380F91F06037B1B4380A0A3CCDB1030E081079E06523CF0F806F636868E459D9168878B11A42C6AB3B6C6B944F849883A91C3067165626D27136A2C1F2AB2B6222F651E014300C731CD818021C57C771D7B1B83998A5A55E774C02E4197529111AEC9DE3642CE4D2654D4AA3AA79168878B1174D4FE5C5165FC8095489B5B22F4A284440A41D4891C567E97C3C33A60C1D1F59309355F6B6243265454F849888A61E51A89F04D23861421EA3A81E60D99507B116EC32AF9C1515144A9D10D57D4A401410D0C2A6A559DD301BB045D4A9DADC84B8053ED049F8A5A55E73412ED7031828E3A91C3C2B82017196D5EA2545B023C0D507B116EB31C2182E0BF52EA440E0BE382B71251959728B517E1C238F9C1515144A922478820C0A9ED650BEE26019E522772D8273C2A5BA2D45E848B71D6DC8B5B4F94450DDE6AD6D63897084F88BA4EA0794326D4E8862B6AD280A00606B5BD6CC1DD24C03F15B5AACEE9805D822EA5CE56E425C0A976029BD4F0A9A855754E23D10E1723E8A813392C8C0B7291D1E6254AB525309B03D45E84DB2C478820F8AF943A91C3C2B8E0AD4454E565429DC8619FF0A86C99507B112E8C931F1C1545942A728408029CDA8B701B56C90F8E8A224AED45B81867CDBDB8F54459540C2BD748843710A2AE1368DE9009B517E136AC921F1C1545941ADD70454D1A10D4C0A0A256D5391DB04BD0A5D4D98ABC0438D54EF0A9A855754E23D10E1723E8A813392C8C0B7291D1E6254AB52548F14FED45B8CD72840882FF4AA913392C8C0BDE4A44555EA2D45E840BE3E407474511A58A1C218200A7B6972DB89B04784A9DC8619FF0A86C89527B112EC659732F6E3D511615430C87B1CE4A8427448D6EB8A2260D086A6050672BF212E054D4AA3AA79168878B1174D4891C16C605B9C868F332A1F622DC66394204C17FA5D45E84DBB04A7E70541451EA3A81E60D9950DBCB16DC4D023CA5A256D5391DB04BD0A55491234410E0545B824FED45B8304E7E705414516A2462C3C5E4E7C251E31CD538BA39774E54782389140FC8522235BEB8F57E848B0A6F2491E26F594AA4C61311D14E64F4652491E266594AA4C6718B8C36AF358C24523C204B89D418155E165223893495A5446A8C0A2F0B662389D42C4B89D418155E163A2389B493A5446A8C0A2F0B062389D4204B89D418155E1602461269409612294E9DC8619FF0A86C8952ED049F3A91C3C2B8E0AD4454E5254AED45B81867CDBDB8F54459540C2BD748844FAEEAE0A6DB1721EA3A81E60D99507B116EC32AF9C1515144A9D10D57D4A401410D0C2A6A559DD301BB045D4A9DADC84B8053ED049F8A5A55E73412ED7031828E3A91C3C2B82017196D5EA2545B822EA5F622DC66394204C17FA5D4891C16C6056F25A22A2F516A2FC28571F283A3A28852458E10418053DBCB16DC4D023CA54EE4B04F7854B644A9BD0817E3ACB917B79E288B8A61E51A89F00F42D47502CD1B32A1F622DC8655F283A3A28852A31BAEA84903821A1854D4AA3AA7037609BA943A5B919700A7DA093E15B5AACE6924DAE162041D7522878571412E32DABC44A9B604296647ED45B8CD72840882FF4AA913392C8C0BDE4A44555EA2D45E840BE3E407474511A58A1C218200A7B6972DB89B04784A9DC8619FF0A86C89527B112EC659732F6E3D511615C3CA3512E10384A8EB049A376442ED45B80DABE407474511A546375C519306043530A8A855754E07EC12742975B6222F014EB5137C2A6A559DD348B4C3C5083AEA440E0BE3825C64B47989526D0952434AED45B8CD72840882FF4AA913392C8C0BDE4A44555EA2D45E840BE3E407474511A58A1C218200A7B6972DB89B04784A9DC8619FF0A86C89527B112EC659732F6E3D511615C3CA3512E193AB3A78D388214588BA4EA0794326D45E84DBB04A7E705414516A74C3153569405003838A5A55E774C02E419752672BF212E0543BC1A7A256D5398D443B5C8CA0A34EE4B0302EC845469B9728D596E0DD517B116EB31C2182E0BF52EA440E0BE382B71251959728B517E1C238F9C1515144A922478820C0A9ED650BEE26019E522772D8273C2A5BA2D45E848B71D6DC8B5B4F9445D512AEDD447842D47502CD1B32A146375C519306043530A8ED650BEE2601FEA9A855754E07EC12742975B6222F014EB513A4864F45ADAA731A8976B81841479DC861615C908B8C362F51AA2D81D91CA0F622DC66394204C17FA5D4891C16C6056F25A22A2F51EA440EFB844765CB84DA8B70619CFCE0A828A25491234410E0D45E84DBB04A7E705414516A2FC2C5386BEEC5AD27CAA26258B94622BCE9F64588BA4EA0794326D45E84DBB04A7E705414516A74C3153569405003838A5A55E774C02E419752672BF212E0543BC1A7A256D5398D443B5C8CA0A34EE4B0302EC845469B9728D596000FBCA9BD08B7598E1041F05F297522878571C15B89A8CA4B94DA8B70619CFCE0A828A25491234410E0D4F6B2057793004FA91339EC131E952D516A2FC2C5386BEEC5AD27CA62512772580CD1FA0302BE9309B53F573A6097004F59D4F86E948C17F09D84A8EB049A3764429DC86165AEB52613EA440E0B091FDB62429DC86183B3B05DCF845A57C137478D7384A8B60436814747B51318DE061675228785848F6D41C2C7B698504BF8D856091FDB224415AE45CE07DF7045953F01F46CA24637478D7384A8B60436E9A7DA093E35BAE18A0A358259D4E8A6AC286363789B038F8FE3BF0B7C336E36B0B7E90C54BF59D488DBE01BAEA8F227809E4DD4E8A6EC29F37E3F3EE6E38D89F94ECD98A9D9CCDEA6EBA8C3F54788BA4EA0794326D45A7B358D1852546A7FAEE497CF1322C00970829400273013E0041D01CEA2B697CF1322C009FEEB4D9012FCD79BC04CF05F294147F059D4FE5CE9805D02DC4C15394204C1A76247580801FE3F55548916818E1A1D763DB53F5754193F6025D2E69608BD2821914210B5D65EF275B59E6AEC047C8DA8FDB96A5895875B6A233E640A039E5464470C2902BCA3A231F9E5F3840870824F90127C0233C127E808FECBC0A2D6DACB74FBA2526BED65F9A5CA64512C6A74D8F584A8EB049A37244AEDCF950ED825C0536A7FAEE497CF1322C00970829400273013E0041D01CEA2B697CF1322C009FE2B254809FEAB233013FCD79BA023C059D45A7B518D5BCB479191446A92446A0C17F62832A2D6DA2BF82655FE04D0B3898A1D612104F8FF543426BF7C9E10014EF00952824F6026F8041DC17F1958D4FE5C5165FC8095489B5B22F4A284440A41D4FE5C35ACCAC32DB5111F3285014F2AB223861481815A6B2FCB2F55268B62519115B91042D47502CD1B32A1F6E74A07EC12E01DB53F57F2CBE70911E00438414A8013980970828E0067516BED15EC776E4D42043821AA13F0A5CA2DEFD795446A92448A21EC1269BCC1EBDB75150F354E646BA9C6ADE591C8482235492235860B3B121949A4F11A47EB91C848B67858042921AA13F0A5CA2DEFD79544DA70D9961A27B2B554E3D6F24864C4223013A23A015F2A86B04BA40D976DA971225B4B35860B3B1219B1083A425427E04B0D5EDFAE2B89B4E1B22D354E646BA9C6D17A2432928DC5A2B697CF1322C009FE2B254809FEEB4D6026F8AF94A023C059D45A7B518D5BCB239191446A92446A0C177624329248E3358ED62391916CF1506BED157C932A7F02E8D944C58EB01002FC7F6A9BC59CF2CBE78952FB734595F10356226D6E89D08B12122904516BED255F57EBA9C6D17A2432928DDA9FAB865579B8A536E243A630E0494576C49022483B2A1A935F3E4F880027F80429C12730137C828EE0BF0C2C6AADBD2CBF54992C8AC5A296F0B1ADE09BA3C63942545B029B07E6836A27C0BBC783454556E4420851DBCBE70911E09479A4DFF008FCDFBDBFF9F17EBFD9DB18CC0429651EE6EEF13BCCCE8C19C0FC0F43CADEC66020305326F078E36F4CFCFD30FF07668A19606F6330B3A8EB049A376442C58EB01002C36751FB6BAD49882A5C8B9C0FBEE18A2A7F02E8D9448D6E8E1AE708516D096CF0FFA976824F8D6EB8A2CA9F007A36B1A8D14D5951C6E681077EDA990D9886B47B04F08EBD4D17A04637654F9907A62180697898BBCEFCF16F08B0B7E93A6A74D8F584A8EB049A37244AEDCF950ED825C0536A7FAEE497CF1322C00970829400273013E0041D01CEA2B697CF1322C009FE2B254809FEAB233013FCD79BA023C059D45A7B518D5BCB479191446A92446A0C17F62832A2D6DA2BF82655FE04D0B3898A1D612104F8FF543426BF7C9E10014EF00952824F6026F8041DC17F1958D4FE5C5165FC8095489B5B22F4A284440A41D4FE5C35ACCAC32DB5111F3285014F2AB22386148181DA6631A7FCF279A2D45A7B597EA93259148B3A5C7F84A8EB049A376442EDCF950ED825C0CDD4FE5CC92F9F27448013E00429014E6026C0093A029C456D2F9F27448013FCD79B2025F8AF378199E0BF52828EE0B3A8B5F66A1A31A4A854912344107C2A76848510E0FF5345956811E8A8D161D753FB734595F10356226D6E89D08B12122904516BED255F57EBA9C64EC0D788DA9FAB865579B8A536E243A630E0494576C49022C03B6AADBD4CB72F2A158DC92F9F274480137C8294E01398093E4147F05F0616B5D65E965FAA4C16C5A2222B722184A8EB049A376442EDCF950ED825C03B6A7FAEE497CF1322C00970829400273013E0041D01CEA2D6DA2BD8EFDC9A840870425427E04B955BDEAF2B89D424891443D825D27883D7B7EB2A1E6A9CC8D6528D5BCB239191446A92446A0C177624329248E3358ED62391916CF1B00852425427E04B955BDEAF2B89B4E1B22D354E646BA9C6ADE591C888456026447502BE540C6197481B2EDB52E344B6966A0C1776243262117484A84EC0971ABCBE5D571269C3655B6A9CC8D6528DA3F54864241B8B456D2F9F27448013FC574A9012FCD79BC04CF05F29414780B3A8B5F6A21AB79647222389D42489D4182EEC48642491C66B1CAD472223D9E2A1D6DA2BF82655FE04D0B3898A1D612104F8FF543426BF7C9E10014EF00952824F6026F8041DC17F1958D4FE5C5165FC8095489B5B22F4A284440A41D45A7BC9D7D57AAA71B41E898C64A3F6E7AA61551E6EA98DF890290C7852911D31A408D28E5A6B2FCB2F55268B6251FD6651236E836FB8A2CA9F007A36B1A8257C6C8B1055B816391F7CC31555FE04D0B3891ADD1C35CE11A2DA127CAA9DC09C7E6A74C315156A049B3E65201635BA292BCAD8BC3BBCC334FFB43363765DD7BDD9DB7406AADF2C6AC46DF00D5754F91340CF26EA70FD11A2AE1368DE9009B53F573A6097003753FB7325BF7C9E10014E8013A4043881990027E8087016B5BD7C9E10014EF05F6F8294E0BFDE046682FF4A093A82CFA2A231F9E5F3840870824F90127C0233C127E808FECBC0A28A1C2182E053B1232C84204D3FB5CD624EF9E5F344A9FDB9A2CAF8012B9136B744E84509891482A8B5F692AFABF5546A7FAE1A56E5E196DA880F99C2802715D911438A000F5045956811E8A8D161D7536BEDD5346248518DF3C66D36A2D6DACBF24B4DF28085153E94489BC40825D2447816353AEC7A42D47502CD1B32A1F6E74A07EC12E029B53F57F2CBE70911E00438414A8013980970828E006751DBCBE70911E004FF9512A404FFD5119809FEEB4DD011E02C6AADBDA8C6ADE5A3C8482235492235860B7B1419516BED157C932A7F02E8D944C58EB0108234FDD4368B39E597CF13A5F6E78A2AE307AC44DADC12A11725245208A2F6E7AA61551E6EA98DF890290C7852911D31A40802543426BF7C9E10014EF00952824F6026F8041DC17F1958D45A7B597EA9491EB0B0C28712699318A1449A08CFA2222B722184A8EB049A376442EDCF950ED825C003D4FE5CC92F9F27448013E00429014E6026C0093A029C45ADB557B0DFB9350911E084A84EC0972AB7BC5F5712A949122986B04BA4F106AF6FD7553CD43891ADA51AB79647222389D42489D4182EEC48642491C66B1CAD472223D9E26111A484A84EC0972AB7BC5F571269C3655B6A9CC8D6528D5BCB2391118BC04C88EA047CA918C22E91365CB6A5C6896C2DD5182EEC4864C422E808519D802F35787DBBAE24D286CBB6D43891ADA51A47EB91C84836168BDA5E3E4F880027F8AF942025F8AF378199E0BF52828E0067516BED45356E2D8F444612A94912A9315CD891C848228DD7385A8F4446B2C543ADB557F04DAAFC09A06713153BC24208D2F453DB2CE6945F3E4F94DA9F2BAA8C1FB01269734B845E94904821885A6B2FF9BA5A4F358ED62391916C12A9ECCAAE446ADC5A1E898CA8FDB96A5895875B6A233E640A039E5464470C2982F44D4563F2CBE70911E0049F2025F80466824FD011FC978145ADB597E5979AE4010B2B7C28913689114AA489F02C6A7453F69409A4EF40FA30E09886002666FA3F7B9BAE63516724DAE162049F1A6561BB9E1035BA292BCAD8BCCD81C0E377E9370702B81937B3B7E90CD4E8B0EB0951D709346FC884DA9F2B1DB04B80A7D4FE5CC92F9F27448013E00429014E6026C0093A029C45EDCF953C8B39E597CF13A5B697CF1322C009FE2B254809FEAB233013FCD79BA023C059D45A7B519D0547D753458E10418053B1232C84204D3FB5CD624EF9E5F34CA8FDB9A2CAF8012B9136B744E84509891482A8B5F692AFABF5546A7FAE1A56E5E196DA880F99C2802715D911438A2040ADB557F04DAAFC09A06713158DC92F9F27448013FC574A9012FC57476026F8AF374147F05F298B5A6B2FCB2F35C9031656F850226D1223944813E159542F4608091FDB8269CFE9805D82B4A30AD722E7836FB8A2CA9F007A3651A39BA3C63942545B029BF47FAA9DE053A31BAEA8F227809E4D2C2AB222174288DA9F2B1DB04B8007A8FDB9925F3E4F880027C00952029CC04C80137404388B5A6BAF60BF736B1222C009519D802F556E79BFAE24529324520C619748E30D5EDFAEAB78A871225B4B356E2D8F444612A94912A9315CD891C848228DD7385A8F4446B2C5C3224809519D802F556E79BFAE24D286CBB6D43891ADA51AB79647222316819910D509F85231845D226DB86C4B8D13D95AAA315CD891C88845D011A23A015F6AF0FA765D49A40D976DA971225B4B358ED62391916C2C16B5BD7C9E10014E9947FA0D8FC0FFDDFB9B1FEFF783BD8DC1409052E6917EC323F07FF7FEE6C7FBFD666F6330139829F348BFE111F8BF7B7FF3E3FD7EB0B73118083A029C45ADB5174C2D1CA72A46B3262888606AADBD826F52E54F003D9BA8684C7EF93C21029CE013A4049FC04CF0093ACA3C02986FFC8189A7691A08E078C7DEC680C9A2D6DA0BA6169E5241033CA9B5F692AFABF554E3683D1219C92691CAAEEC4AA4C6ADE591C888DA9FAB865579B8A536E243A630E049ADB5174C2DDC4C050DF0A4D6DACBF24B4DF28085153E94489BC40825D24478EA3A81E60D99506BED65BA7D51A9B5F6A21AB79647222389D42489D4182EEC48642491C66B1CAD472223D9E2A18A1C218200A762475808419A7E6A9BC59CF2CBE79950FB734595F10356226D6E89D08B1212290451911D31A408D237B53F57F22CE6945F3E4F94458D6ECA9E323601F3FF98668321C50C609AF177C7DEA6EBA87EB3A811B7C1375C51E54F003D9BA85E8C10123EB605D39E6BF4FDDC9215C1A7C22F4EA079895287EB8F10B53F573A6097003753FB7325BF7C9E10014E8013A4043881990027E8087016B53F57F22CE6945F3ECF84DA5E3E4F8800A74C6748F13480FF00E623901A029FBD8DE14D9052A633A4781AC07F00F311480D81CFDEC6F0263053A633A4781AC07F00F311480D81CFDEC6F026E8083E8B5A6BAFE09B54F91340CF262A1A935F3E4F8800A74C6748F13480FF00E623901A029FBD8DE1419052A633A4781AC07F00F311480D81CFDEC6F0203053A633A4781AC07F00F311480D81CFDEC6F020E82813781B30BFA1C3DFF8E3F1E8FE9BBD8DE1C1A2D6DA4BBEAED6538D5BCB4791916CD4FE5C35ACCAC32DB5111F3285014F6AADBD2CBFD4240F5858E14389B4498C50224D84A7AE1368DE9009B5D65EA6DB17D5D809F81A516BED457502BEB248DEB8CD54912344107C2A76848510A4E9A78A2AD122D051A3C3AEA7F6E78A2AE307AC44DADC12A11725245208A2223B624811E0016AADBD9A460C29AA71DEB8CD46D4368B39E597CF1365B1A8D1CD51E31C21AA9DC0C6F0EE582C168B04",
    ["1080p"] = "MUIV2:034F10390025A2C82811C52911A55B94CA2E55F18B2A61982AC7A05A26A5671499A6AAAE51B08D2ABE89D438A9380745EB8802DE11851C14512D14F290A82652255D84C246A2F491286A2485E8A4AAF49228546652543721D809FC14C95011392A956AA954F2943415E4AA54CA56AA445F8942692C85D059A2A0B544A1EA2D45B94BA1F6A2BF44A130984887098B213D966232555D56DA2C559F45180DEAB4C26B0A69B6A8DB10EDA6F25B65B850C7890265B9E0B9A2E992EB946CA74A7D87D2784A394FA95A0FA1F91482F61371AB2810C78A02E96185C0ABA240B5AA28144D9C101529862344459E6FE59D84A848114F46D46EDFC8AA3A3719514553E31C2AC264442DEC0AA39311756E593123EA343ADC64446DEEB27F583789522D37AA0F02B99311151581118B5AF0229710154DC82F5F20448013BC0F4ED012BC0F4E6022781F9CE027789F0E8BDA9F2BAA6C18881269774BF8419490482188DA9F2B1D884B80B754F482BF417EF90221029CE011B4048FC044F0087E029CC562519D40EE8C45B3931015C2AE303A09510732BE5029EF0DD8306A319C40F3FA8CA803195FA894F7066C18B55EB717562EA25478F82B73B08FE1739311151EFE46221189C088DA8B59E677C58845D52D2B264485C5941F32CE5BEBEB961533625111443C0951277C58197F6E8952277C582888C6E870094654D4AA3A17892043CADAFD1EFC7970CC3FFD637A3A86B487BDDDFF53AFEFE7961109F034B53F5729ABF2704B4D7583CCBF0083DAE46B8C12A2DA13D8B5541BC1A3C6375C51A31404A510A8CDE50B840870029CA025C0094C0438C14F80B358D4091F569EAF314A948A1423A7FA7E6EC990C00EA7A256D5B948042312D8BD8FE1C7710FA6E737FDAFC5A9C2AA93F177484654D4AA3A1789105955E766D286AEC312E08F8A5A55E7221192BB06BE408552495D5F998D84A8F1CD51E31C21AA3D65ED3C9878C783BF4EA7F5183AA667626FF777A836CADA79DE33783C98983F66C763C0ECFCECED0C2D8B7A7D3FB7644860A04E58C44BD5EEDD92776150277C58AFA3EF4763E5B2274AEDCF950EC425C05B2A6A559D8B44905FBE40882A08706A20781F033541F03E062A4AF03E061615B5AACE4522C82F6711CFF575202E41FBA8CD5DF02721AA3D01DE526D048F1ADF70458D52109442A036972F1022C00970829600273011E0043F01CE6251277C58B9C8EB7C118852277CD8EED65ACB888A5A55E722113416CD7009824745ADAA739108DDE6CAB398537EF90223EA840F2BBF0BFE244AF547DF8FC6CA659FEAFBB96544023B8F81EA8FBE1F8D95CB3ED5F7734B860476062AE2B92544B52730506D048F1ADF7045855249D4E6F205420438014ED012BC4F87C044F0087E029CC5A2A256D5B948040C27D0BC3E23EA840F8B30E61CE72651EA840F8B2046664445ADAA7391089155754E07E212985AEA1C884BD0B68F8A5A55E72211640E872DD8EB08DBD43847CDDB1715B5AACE45227C9B73DA88BC0438B53F5754D9301025D2EE96F08328219142101529464EF5FDDC3222811DCEA2AAD1E10851A7D1E12291988CA8D3E870C99B1AE7221126232A6A559D8B2EF81BE4972F1022C0091E414BF0084C048FE027C059D46974B8280F4444117CD920903B1951A7D1E1BAB951B241207712A5A256D5B948344613E12CE7CB2F5F20448013BC0F4ED012BC0F4E6022781F9CE027789F0E8B3A8D0E278745C90681DC49943A8D0EE7559488C219DD1089301951A7D1E110861B481133A24EA3C375FB4656D5B9C9883A8D0E07DDE51AF164444DE4434556A3C3511186EF46022E16B59B1B251B04722721EA3A81E6F51951277C58D96BACC9883AE1C3422224B61851277CD8A42CEC3730A2960889AD1221B145882A5C035F48BAE18ADAF595D948881ADF1C35CE11A2DA13D8B58F6A2378D4F8862B2A944A625187EB8F10759D40F3FA8CA8FDB9D281B804B889DA9F2BF9E50B840870029CA025C0094C0438C14F80B3A8CDE50B84087082F7E910B404EFD3213011BC4F4BF0133C16B5D656E6DB17952A720C0B8247C50EBF6002FC3DAAA8120D0C1D353EEC066A7FAEA8B261204AA4DD2DE10751422285206AADADE4EB6A03D5CC09E41A53FB7395B22A0FB7D45437C8FC0B30A8F08E045C04F84F4513F2CB170811E0048FA0257804268247F013BC8F8145ADB555D748C045A5D6DACA0A4B95CDA258D4F8A611296B97EE3CCF8FB71DD38F89E969DB9FBDDDFF53E115B96042D47502CDEB33A2F6E74A07E212E03FB53F57F2CB170811E00438414B8013980870829F0067516B6D9514766E4D42043821AA13C8A5CAAD10D69544EA85448A206C126932491B9A75952CD55B646BA9668D15E0D85822F5422235430A1B1C1B4BA4C998C51BE0D858A66459042D21AA13C8A5CAAD10D695449A72D99EEA2DB2B554B3C60A706CCC223011A23A815C2A82B049A42997EDA9DE225B4B35430A1B1C1BB3087E425427904B4DDAD0AC2B8934E5B23DD55B646BA966F10638369689C5A236972F1022C009DEA7256809DEA7436022789F96E027C059D45A5B51CD1A2BC0B1B144EA85446A8614363836964893318B37C0B1B14CC9526B6D9574932AC700104617153BFC8209F0F7A84D1673CA2F5F204AEDCF1555360C4489B4BB25FC204A48A41044ADB5957C5D6DA09AC51BE0D858266A7FAE5256E5E1969AEA06997F010615DE91808BA0FDA968427EF90221029CE011B4048FC044F0087E82F731B0A8B5B6B2C25265B3281635BE2943CADA793C1D1C6FF1B40933ED49775E87BDDD6FA086CDA286F726DD7045EDFACA6C24448D0FBB8110759D40F3FA44A9FDB9D281B804784BEDCF95FCF205420438014ED012E00426029CE027C059D4E6F205420438C1FBB4042DC1FBFC042682F7E910FC04388B5A6B2BAA59638538369648BD9048CD90C216C7C6D45A5B25DDA4CA310084D145C50EBF6002FC3D2A9A905FBE4088002778042DC12330113C829FE07D0C2C6A7FAEA8B261204AA4DD2DE10751422285206A7FAE5256E5E1969AEA06997F010615DE91808BC040ADB59515962A9B45B158D4091F161221B1058990D862449DB168864B103C6A8990D84ABA396A9C2344B527B04B63A6A93602FC4FA7595478452E9810759D40F3FA8CA8CDE50B840870CAA6DB67487BDEFB3BCF94EE743AECED0C268296B269D39F7E3FE66FC2F460BEB4A1656F6730109828EB4977F00E26DE499B5E1AB3C5F4B0B733985854ECF00B26303C1635BE396A9C2344B511D8193A3F8B5A2224B60851856BE00B49375C51A31404A510A8F1CD51E31C21AA3DC1A3DA084CEDA3C6375C51A1549239862CC4A20ED71F21EA3A81E6F51951FB73A50371097013B53F57F2CB170811E00438414B8013980870829F0067519BCB170811E004EFD3216809DEA7436022789F96E027782C2A9A905FBE4088002778042DC12330113C829FE07D0C2CAAC8312C081E153BFC8209DAF65145956860E8A8F1613750FB7345950D035122ED6E093F8812122904516B6D255F571BA8D4FE5CA5ACCAC32D35D50D32FF020C2ABC23011701EEA1D6DAAA6B24E0A29AE5F5DE6C4C6DB298537EF902516AADADACB0D4280F4444117C89B44B0C5F228D446051E39B46A4ACA1D3C13D0653E76F314D86CEEBB0B7FB7F2ABC22174C88BA4EA0797D46D4FE5CE9405C02DC43EDCF95FCF205420438014ED012E00426029CE027C059D45A5B25859D5B9310014E88EA0472A9722B847525917A219122089B449A4CD286665D254BF516D95AAA59630538369648BD9048CD90C206C7C612693266F106383696295916414B88EA0472A9722B84752591A65CB6A77A8B6C2DD5ACB1021C1BB3084C84A84E20978A206C1269CA657BAAB7C8D652CD90C206C7C62C829F10D509E452933634EB4A224DB96C4FF516D95AAA59BC018E8D6562B1A8CDE50B84087082F769095A82F7E9109808DEA725F8097016B5D65654B3C60A706C2C917A21919A21850D8E8D25D264CCE20D706C2C53B2D45A5B25DDA4CA310084D145C50EBF6082B67DD4268B39E5972F10A5F6E78A2A1B06A244DADD127E1025245208A2D6DA4ABEAE3650CDE20D706C2C93446A844628919A35568063636A7FAE5256E5E1969AEA06997F010615DE91808BA0ED50D184FCF205420438C12368091E8189E011FC04EF6360516B6D6585A5467920228AE04BA45D62F8126924028B1ADF9421653B69CCD7B686D79A701366E77FECED7E03356C1635BC37E9862B6A9482A01402353EEC0642D47502CDEB33A2F6E74A07E212E02DB53F57F2CB170811E00438414B8013980870829F0067519BCB170811E004EFD312B404EFF3139808DEA743F013E02C6AADADA8668D15E2D85822F5422235430A5B1C1B536B6D9574932AC700104617153BFC8209DAF6519B2CE6945FBE4094DA9F2BAA6C18881269774BF8419490482188DA9FAB945579B8A5A6BA41E65F8041857724E022F050D184FCF205420438C12368091E8189E011FC04EF6360516B6D6585A5467920228AE04BA45D62F8126924028B458DB3B0DF40881ADF9421653B69CFC37C9878C78389F95EE7B1B7FB0DD4F8B01B0851D70934AFCF88DA9F2B1D884B80B7D4FE5CC92F5F20448013E0042D014E6022C0097E029C45EDCF953C8B39E5972F10A536972F1022C009DEA7256809DEE7273011BC4F87E027C059D45A5B519D85443750458E61418053B1C32F98A06D1FB5C9624EF9E50B8CA8FDB9A2CA8681289176B7841F4409891482A8B5B692AFAB0D546A7FAE5256E5E1969AEA06997F010615DE91808BC043ADB555D24DAA1C0340185D543421BF7C8110014EF03E2D414BF03E3F8189E07D3A043FC1FBB42C6AADADACB0D4280F4444117C89B44B0C5F228D44605183183E244262EBDB9CD381B804ED4F15AE812F24DD70458D52109442A0C637478D7384A8F60476ED7B541BC1A3C6375C51E51800C2E8625191E72DD0BC44A961B3A8E1BD49375C51A31404A510A8C3F547885A6BABAE91808B6A96D77BB331B53F57F2CB170811E00438414B8013980870829F006751FB7325CF624EF9E50B8CA8CDE50B840870CAFE86166F3DF8F360A63DADC1F3D8DB193A042D657F438BB71EFC7930D39ED6E079ECED0C1D0213657F438BB71EFC7930D39ED6E079ECED0C1D829FE0B1A8B5B64ABA4995630008A38B8A26E4972F1022C029FB1B5ABCF5E0CF8399F6B406CF636F674813B494FD0D2DDE7AF0E7C14C7B5A83E7B1B733A4094C94FD0D2DDE7AF0E7C14C7B5A83E7B1B733A4097ECA7A3A06CC67F8F10E9E4EA7FFD7616F6748B3A8B5B692AFAB0D54B3C60A716C2C13B53F5729ABF2704B4D7583CCBF00835A6B2B2B2C35CA031151045F22ED12C397482311A8EB049AD76744ADB595F9F645357302B9C6D45A5B519D40AE8C91D77B3355E41816048F8A1D7EC1046DFBA8A24A343074D4F8B01BA8FDB9A2CA8681289176B7841F4409891482A8F08E045C04B887DA9F2B1D884B809BA84D1673CA2F5F20CAA206317C4884C4D6B73997EAFBB9254382478D6F1A91B27686CEFF3C2F8D89FF6D8B99F63CF676FF4F8557E4820951FB73A5037109700FB53F57F2CB170811E00438414B8013980870829F0067516B6D9514766E4D42043821AA13C8A5CAAD10D69544EA85448A206C126932491B9A75952CD55B646BA9668D15E0D85822F5422235430A1B1C1B4BA4C998C51BE0D858A66459042D21AA13C8A5CAAD10D695449A72D99EEA2DB2B554B3C60A706CCC223011A23A815C2A82B049A42997EDA9DE225B4B35430A1B1C1BB3087E425427904B4DDAD0AC2B8934E5B23DD55B646BA966F10638369689C5A236972F1022C0299B6E9F21ED79EFEF3C53BAD349B3B73318085ACAA6DB67487BDEFB3BCF94EE743AECED0C26021365D3ED33A43DEFFD9D674A773A69F6760603C14F80B3A8B5B6FAD62271AA2224EF828C4CA2D6DA2AE926558E01208C2E2A9A905FBE4088002778042DC12330113C829FB2690F66074F63E26DDB7A3C38FEB3B73360B2A8B5B6FAD6225B2A48010C6AADADE4EB6A03D52CDE00C7C63249A446688412A95963053836A6F6E72A65551E6EA9A96E90F91760506B6DF5AD459AA8200530A8B5B6B2C252A33C101145F025D22E317C89341281BA4EA0797D46D45A5B996F5F546AADADA8668D15E0D85822F5422235430A1B1C1B4BA4C998C51BE0D858A664A922C7B020C0A9D8E1174CD0B68FDA6431A7FCF20546D4FE5C5165C3409448BB5BC20FA284440A41547847022E82B643EDCF953C8B39E5972F1065B1A8FD35D6244415AE812F24DD704595630008A38B1ADF1C35CE11A2DA13D8E1EF516D048F1ADF704595630008A38B451DAE3F42D47502CDEB33A2F6E74A07E212E0266A7FAEE4972F1022C00970829600273011E0043F01CEA236972F1022C009DEA743D012BC4F87C044F03E2DC14FF058D45A5B996F5F54AAC8312C081E153BFC8209F0F7A868427EF90221029CE011B4048FC044F0087E82F731B0A8FDB9A2CA8681289176B7841F4409891482A8B5B692AFAB0D543327906B4CEDCF55CAAA3CDC5253DD20F32FC0A0C23B127011E03FB5D6565D230117952AAA440343478D0FBB815A6B2B2B2C55368B6251C36651C37B936EB8A2CA310084D1458557E4820951D70934AFCF88DA9F2B1D884B80FFD4FE5CC92F5F20448013E0042D014E6022C0097E029C45ADB55552D8B9350911E084A84E20972AB742585712A917122982B049A4C9246D68D655B2546F91ADA59A355680636389D40B89D40C296C706C2C912663166F80636399926511B484A84E20972AB74258571269CA657BAAB7C8D652CD1A2BC0B1318BC04488EA0472A908C22691A65CB6A77A8B6C2DD50C296C706CCC22F809519D402E356943B3AE24D294CBF6546F91ADA59AC51BE0D85826168BDA5CBE40880027789F96A025789F0E8189E07D5A829F0067516B6D45356BAC00C7C612A91712A91952D8E0D858224DC62CDE00C7C632254BADB555D24DAA1C0340185D54ECF00B26C0DFA3A209F9E50B8408708247D0123C0213C123F809DEC7C0A2F6E78A2A1B06A244DADD127E1025245208A2D6DA4ABEAE3650CDE20D706C2C13B53F5729ABF2704B4D7583CCBF00830AEF48C045D0FED45A5B5961A9B259148B1ADF942165ED7E4FFA754C1D4FFA3718FE4EE7B1B7FB0DD4F8A611299B7ECF8399C6EC98FE74DA64783F7BBBFFA7C687DD4088BA4EA0797DA2D4FE5CE9405C02BCA5F6E74A7EF90221029C00276809700213014EF013E02C6A73F90221029CE07D5A8296E07D7E0213C1FB74087E029C45ADB515D5ACB1421C1B4BA45E48A46648618B63636AADAD926E52E51800C2E8A262875F3001FE1E154DC82F5F204480133C8296E01198081EC14FF03E0616B53F5754D9301025D2EE96F0832821914210B53F5729ABF2704B4D7583CCBF00830AEF48C04560A03659CC29BF7C8128B5D6565658AA6C16C56251EB2AE9E6A8718E10D59EC0CE93FEA9360243C7C06251BB7D23ABEADC24445D27D0BC3E236A7FAE74202E41FBA8B3117909DEC743EDF68DACAA739310756DA30851D70934AFCF887AC1DF40D0B2A817D738370951D70934AFCF887AC1DF4060625185EF9F9B84A8EB049AD76744BDE06F20F85954E4792F21EA3A81E6F519512FF81B080C2C6AD87CC227445D27D0BC3E23EA057F0301CE6251FB7345950D035122ED6E093F881212290451E39BA3C63942547BCAFE9D4E1AF7780CB8C9904E63767EF676BF876AA3AC5DBAFD3B989EF79B30D3B8298D89B3B7FB31A9F10D57D42805412984AEAFCC46422C6ABEC6E8FA44A9A8688C26C259CE975FBE408800A76CDAF4A7DF8FF99B303D982F6D30B0B73378085ACAA64D7FFAFD98BF09D383F9D206037B3B8387C044D9B4E94FBF1FF337617A305FDA60606F67F010FC94ED183C06DC93C65B4F8B7BD2CFC0DECEF0B3A83316CD70098296454DDED4381789300951277C5823AF8CAEFD64444DE44345D646E4A56CDA63F0E038A6C9E331B4989DFF676F67305151ABEA9C0EC4253079A8F0F057E6601FC3E726232A6A559DD35834C325087E6A7FAEA8B261204AA4DD2DE1075142228520EA840F2BBFCBFE611DB090E886C9889AAF31BA3E232A2AC2244445B0728D4884AE91808B10759D40F3FA8CA8BDF0376595FC90A828A2D4F8862B6A9482A0140215B5AACEE9405C0293873A1B919700A7DA081E15B5AACE692C9AE112043F75C287FD3A2F171E4D5EA2547B02FC61527BE16FF21CC382E07D5AEA840FFB75495B91A8CA4B94DA0B7FBF4E7E48541451AAC8312C08706A73D942BA4980B7D4091F160319973D516A2FFC45386BEE796F20CAA2266D256F6A9C8B4420445D27D0BC3E23AA8DE03779A8F10D57D428054129042A6A559DD381B804260F7536222F014E9DF061BF2E692B125579195151ABEA9CC6A2192E41F053277CD8AFF372E1D1E4254AB52768710FB517FE26CF312C08DEA7A54EF8B018C8B8EC19517BE1EFD7C90F898A224A15398605014E6D2E5B483709F047ED85BF29ABE487444511A5F6C25F84B3E69EF706A22C2A82956B4422180851D70934AFCF88DA0B7F5356C90F898A224A8D6FB8A24629084A215051ABEA9C0EC4253079A8B311790970AA8DE05151ABEA9CC6A2192E41F053277CD8AFF372E1D1E4254AB527C03B38B517FE26CF312C08DEA7A54EF8B05F97B41589AABC44A9BDF0F7EBE487444511A58A1CC38200A736972DA49B04784B9DF061319071D913A5F6C25F84B3E69EF706A22C2A82180E619D158940881ADF70458D52109442A0CE46E425C0A9A855754E63D10C9720F8A9133EECD779B9F068F232A2F6C2DFE4398605C1FBB4D45EF89BB24A7E48541451EA3A81E6F519519BCB16D24D02BCA5A256D5391D884B60F250458E61418053ED091EB517FE7E9DFC90A828A2D45824864BC8CFF9A3C639AA597C73EE9CA808C61229EE9191446A76DE1BC2F01715C15822C53B329248CD262CE29DF0E8CB5822C54D329248CDBC171E4D5E6B184BA4B8474612A9192A820CB4C612692B2389D40C1541064CC612A9494612A9192A820CFCC612E92F2389D40C1541060CC612A9414612A9192A820C788C25528F8C24529C3AE1C36220E3B2274AB5113CEA840FFB75495B91A8CA4B94DA0B7F11CE9A7BDE1B88B2A80856AE1189105DD521CDB72F42D47502CDEB33A2F6C2DF9455F243A2A28852E31BAEA8510A82520854D4AA3AA70371094C1EEA6C445E029C6A237854D4AA3AA7B168864B10FCD4091FF6EBBC5C7834798952ED094C696A2FFC4D9E635810BC4F4B9DF061BF2E692B12557989527BE1EFD7C90F898A224A15398605014E6D2E5B483709F0963AE1C36220E3B2274AED85BF0867CD3DEF0D445954042BD788444813A2AE13685E9F11B517FEA6AC921F121545941ADF70458D52109442A0A256D5391D884B60F2506723F212E0541BC1A3A256D5398D45335C82E0A74EF8B05FE7E5C2A3C94B946A4FD01A4CD45EF89B3CC7B020789F963AE1C37E5DD25624AAF212A5F6C2DFAF931F121545942A720C0B029CDA5CB6906E12E02D75C287C540C6654F94DA0B7F11CE9A7BDE1B88B2A80856AE1189E021445D27D0BC3E236A2FFC4D59253F242A8A2835BEE18A1AA52028854045ADAA733A1097C0E4A1CE46E425C0A936824745ADAA731A8B66B804C14F9DF061BFCECB8547939728D59EA0C5D3D45EF89B3CC7B020789F963AE1C37E5DD25624AAF212A5F6C2DFAF931F121545942A720C0B029CDA5CB6906E12E02D75C287C540C6654F94DA0B7F11CE9A7BDE1B88B2A80856AE1189105DD521BB46022E42D47502CDEB33A2F6C2DF9455F243A2A28852E31BAEA8510A82520854D4AA3AA70371094C1EEA6C445E029C6A237854D4AA3AA7B168864B10FCD4091FF6EBBC5C7834798952ED09D2266A2FFC4D9E635810BC4F4B9DF061BF2E692B12557989527BE1EFD7C90F898A224A15398605014E6D2E5B483709F0963AE1C36220E3B2274AED85BF0867CD3DEF0D4459542DE19A8D4420445D27D0BC3E23AA8DC0EE3779A8F10D57D428054129042A6A559DD381B804260F7536222F014E9DF061BF2E692B125579895251ABEA9CC6A2192E41F053277CD8AFF372E1D1E4254AB52768710FB517FE26CF312C08DEA7A54EF8B018C8B8EC19517BE1EFD7C90F898A224A15398605014E6D2E5B483709F047ED85BF29ABE487444511A5F6C25F84B3E69EF706A22C2A82956B4422986F5F84A8EB049AD76744ED85BF29ABE487444511A5C6375C51A31404A510A8A855754E07E212983CD4D988BC0438D546F0A8A855754E63D10C9720F8A9133EECD779B9F068F212A5DA13E0BF81DA0B7F93E7181604EFD352277CD8AF4BDA8A44555EA2D45EF8FB75F243A2A28852458E614180539BCB16D24D02BCA54EF8B018C8B8EC89527BE12FC25973CF7B0351168B3AE1C32288261C10C89D8CA8FDB9D281B80478CBA2462210A2A2E18C6E9884A80862CA60D612A24EF8B0E602DD4C943AE1C37E9B738CA8133EACFC2EF8932855E491705439068030BAA8133E2CB4B66244BDE06F20C01F1515810ACE2D8B0A3686BB7D2552F95DF60FEB245204E144620321EA840F6B2ED0CD44A9133EECB739C7883AE1C3CAEF823F8952451E094795630008A38B3AE1C3426B2B46D40BFE0602FC515111A8E0DCB2A808C377230197572B0842D4091F567E17FC49942AF24838AA39862C44B5E67ADD662045264A9DF061CD05BA991175C287FD36E71851ADB90A5F2873816E264AF5BE6C21576B6382F77906EA840F0BADAD18512FF81B08F0474545A08273CBA24656424563941075C28795DF057F12A58A3C128E6A8E210B51ADB95EB71948918952277C5873816E66449DF061BFCD3946546BAEC217CA5CA09B8952BD2F5BC8D5DA98E07D9E813AE1C3426B2B46D40BFE0602FC515111A8E0DCB2A808C3772301973C5F63941075C28795DF057F12A58A3C128E2AC700104617D59AEB759B8114992875C2873517E866A2D4091FF6DB9C6344B5E62A7CA1CC05BA9928D5FBB2855CAD8D09DEE719A8133E2CB4B66244BDE06F20C01F1515818A20868B4460511186EF46022EF36B448D7384A8133EACFC2EF8931155E49170D4AEAFCC4642546BAEC217CA5CA09B8952ADB95EB71948918952277C5873816E264A9DF061BFCD3946D4E62EF85EB719489127C1A37A5FB690ABB531C1FB3C0375C28785D6568CA817FC0D04EDA3A2225011C47091082C2AC2F0DD48C0E575F43D21EA840F2BBF0BFE244A1579241CB5EB2BB39110D59AEB759B8114992875C2873517E866A2D4091FF6DB9C6344B5E62A7CA1CC05BA9928D5FBB2855CAD8D09DEE719A8133E2CB4B66244BDE06F20303D2A2A0215410C1789C0A27A3DE470370951277C5873816E264A9DF061BFCD3946D4091F567E17FC49942AF24838AA1C0340185DD4091F165A5B31A25EF03710E08F8A8A4005E796454518BE1B09B8A033BA8E1075C28795DF057F12A58A3C128E2AC700104617D59AEB759B8114992875C2873517E86646D4091FF6DB9C6344B5E62A7CA1CC05BA9928D5FBB2855CAD8D09DEE719A8133E2CB4B66244BDE06F20C01F1515810ACE2D8B8A307C3712707979D9422E21EA840F2BBF0BFE244A1579241CB5EB2BB39110D59AEB759B8114992875C2873517E866A2D4091FF6DB9C6344B5E62A7CA1CC05BA9928D5FBB2855CAD8D09DEE719A8133E2CB4B66244BDE06F20C01F1515818A20868B4460511186EF46022ED930D6F9931075C28795DF057F12A58A3C128EDAF595D948886ACDF5BACD408A4C943AE1C39A0B743323EA840FFB6DCE31A25A7315BE50E602DD4C94EA7DD942AED6C604EFF30CD4091F165A5B31A25EF03710981E1515810ACE2D8B8A307C371270A9FDAC4512A24EF8B0F2BBE04FA2549147C251CD316421AA35D7EB3603293251EA840F6B2ED0CD8CA8133EECB739C7886ACD55F842990B743351AAF7650BB95A1B13BCCF3350277C58686DC5887AC1DF40607A5454042A82182E1281454518BE1B09B864BEEC13A24EF8B0F2BBE04FA2549147C251CD316421AA35D7EB3603293251EA840F6B2ED0CD8CA8133EECB739C7886ACD55F842990B743351AAF7650BB95A1B13BCCF3350277C58686DC5887AC1DF40F03F2A2A0215410C1789C0A2220CDF8D045C91484C42D4091F567E17FC49942AF24838AA39862C44B5E67ADD662045264A9DF061CD05BA991175C287FD36E71851ADB90A5F2873816E264AF5BE6C21576B6382F77906EA840F0BADAD18512FF81B08F0474545A08273CBA2220CDF8D045C5F73EF4C883AE1C3CAEF823F8952451E094735C79085A8D65CAFDB0CA4C844A9133EACB9403733A24EF8B0DFE61C23AA3557E10B652ED0CD44A9DE972DE46A6D4CF03ECF409DF061A1B51523EA057F0301FEA8A80854706E595484E1BB91804B666B649F1075C28795DF057F12A58A3C128E6A8E210B51ADB95EB71948918952277C5873816E66449DF061BFCD3946546BAEC217CA5CA09B8952BD2F5BC8D5DA98E07D9E813AE1C3426B2B46D40BFE0682FF515111A8E0DCB258D4FE5CC92F5F20440D04383541805351029C45EDCF950EC425C04DD4198B66B804016EA06631CBCBCB16720970031515418D0E474518BE1B09B8A8FDB9A2260F4364891488100E4BB5E66A09E78BE04303B98CA87546D71939665DB027448013A2C661344B607AEFC734BDF71EB5067209F074FA3DFCA50D1D16414B881A87D12C418B89F90C98EFBD47AD815C023C9D7E0F7F38A689456022448DC36896A0C54C3F13E67BEF516B2097004FA7DF7B1DCC87C922F80951E3309A256831FF348EBFF71EB5067209F074FABD67C0F47858040642D4388C66095ACCFFE1E9F7DEA3D6402E019E4EBFF7FE8EC1C0625113977DAFA20421AA97EB122B5C630432B8446A2791CA1C062262B697488D1C394F42D4268B39A95E311052C0C86E00C2E8A20AE459AE080C0643C7D431BDCEF3B0A8495688AD2024523B8954E6301011B3BD446AE4C87912A20AE459AE08F067C2FFF70C9E9FDA643127D56B57B7AF5716350A0339EB9C11C89812A99D440AC141E44C88DA64312755C626EF324FC9651C5520CF7245D07998B8C78089B3A8C9AD7041F8026B0432A8446A27914270103913A23659CC494D4A6E9EDCEB175005F22C570426CCE731FD86D66462519323370F2191DA49A43287818898ED25522347CE93105520CF72456032B46DA7FD4DE934B5C9624E2A420AC8381635258CAE9BB011C8209B7D89D44E2295390C44C46C2F911A39729E84A84D16735293929B27F7FA0554813CCB1501DEC10D981DCF8FB35854548449888A20868B4420445D27D0BC3E236A7CC315154A25516723F212E0D4FE5C5165C3409448BB5BC20FA284440A415491635810BC8F878A1D7EC1049EF7A8BD95B38C1D7EC18CA83682476D2E5F20440D04EF83531304EF83535182F7C159D46974382AC2F0DD48C045857724E022687F6A2C7C7FB80401FEA8F6048F5A6B2B2B2C35CA031151049FC5A25A73E559CC29BF7C8111355F63747D462C168B04",
}

function Setup:OnInitialize()
    self:RegisterMessage("MIDNIGHTUI_DB_READY", "OnDBReady")
end

function Setup:OnDBReady()
    if not MidnightUI.db.profile.modules.setup then 
        self:Disable()
        return 
    end
    
    self.db = MidnightUI.db:RegisterNamespace("Setup", defaults)
    
    -- Show wizard on first login
    if not self.db.profile.hasCompletedSetup then
        C_Timer.After(2, function()
            self:ShowSetupWizard()
        end)
    end
end

function Setup:ShowSetupWizard()
    if self.wizardFrame then
        self.wizardFrame:Show()
        return
    end
    
    -- Create main wizard frame
    local frame = CreateFrame("Frame", "MidnightUI_SetupWizard", UIParent, "BasicFrameTemplateWithInset")
    frame:SetSize(600, 400)
    frame:SetPoint("CENTER")
    frame:SetFrameStrata("DIALOG")
    frame:SetMovable(true)
    frame:EnableMouse(true)
    frame:RegisterForDrag("LeftButton")
    frame:SetScript("OnDragStart", frame.StartMoving)
    frame:SetScript("OnDragStop", frame.StopMovingOrSizing)
    
    frame.title = frame:CreateFontString(nil, "OVERLAY", "GameFontHighlightLarge")
    frame.title:SetPoint("TOP", 0, -5)
    frame.title:SetText("MidnightUI First Time Setup")
    
    -- Current step tracker
    frame.currentStep = 1
    frame.selectedResolution = nil
    
    -- Content area
    frame.content = CreateFrame("Frame", nil, frame)
    frame.content:SetPoint("TOPLEFT", 15, -35)
    frame.content:SetPoint("BOTTOMRIGHT", -15, 50)
    
    -- Create step 1: Welcome & Resolution Selection
    self:CreateStep1(frame)
    
    -- Create step 2: Confirmation
    self:CreateStep2(frame)
    
    -- Navigation buttons
    frame.backButton = CreateFrame("Button", nil, frame, "UIPanelButtonTemplate")
    frame.backButton:SetSize(100, 25)
    frame.backButton:SetPoint("BOTTOMLEFT", 15, 15)
    frame.backButton:SetText("Back")
    frame.backButton:Hide()
    frame.backButton:SetScript("OnClick", function()
        self:GoToStep(frame, frame.currentStep - 1)
    end)
    
    frame.nextButton = CreateFrame("Button", nil, frame, "UIPanelButtonTemplate")
    frame.nextButton:SetSize(100, 25)
    frame.nextButton:SetPoint("BOTTOMRIGHT", -15, 15)
    frame.nextButton:SetText("Next")
    frame.nextButton:SetScript("OnClick", function()
        if frame.currentStep == 1 then
            if not frame.selectedResolution then
                print("MidnightUI: Please select a resolution first!")
                return
            end
            self:GoToStep(frame, 2)
        elseif frame.currentStep == 2 then
            self:CompleteSetup(frame)
        end
    end)
    
    frame.skipButton = CreateFrame("Button", nil, frame, "UIPanelButtonTemplate")
    frame.skipButton:SetSize(100, 25)
    frame.skipButton:SetPoint("BOTTOM", 0, 15)
    frame.skipButton:SetText("Skip Setup")
    frame.skipButton:SetScript("OnClick", function()
        self.db.profile.hasCompletedSetup = true
        frame:Hide()
        print("MidnightUI: Setup skipped. You can run this again from the settings.")
    end)
    
    self.wizardFrame = frame
    self:GoToStep(frame, 1)
    frame:Show()
end

function Setup:CreateStep1(frame)
    local step1 = CreateFrame("Frame", nil, frame.content)
    step1:SetAllPoints()
    step1:Hide()
    
    -- Welcome text
    local welcomeText = step1:CreateFontString(nil, "OVERLAY", "GameFontNormalLarge")
    welcomeText:SetPoint("TOP", 0, -20)
    welcomeText:SetText("Welcome to MidnightUI!")
    welcomeText:SetTextColor(0, 1, 0)
    
    local infoText = step1:CreateFontString(nil, "OVERLAY", "GameFontNormal")
    infoText:SetPoint("TOP", welcomeText, "BOTTOM", 0, -15)
    infoText:SetWidth(550)
    infoText:SetJustifyH("LEFT")
    infoText:SetText("This wizard will help you set up MidnightUI with optimized settings for your screen resolution.\n\nPlease select your monitor's resolution:")
    
    -- Resolution selection buttons
    local resolutions = {
        {name = "4K (3840 x 2160)", key = "4K", y = -120},
        {name = "1440p (2560 x 1440)", key = "1440p", y = -170},
        {name = "1080p (1920 x 1080)", key = "1080p", y = -220},
    }
    
    step1.resButtons = {}
    for _, res in ipairs(resolutions) do
        local btn = CreateFrame("Button", nil, step1, "UIPanelButtonTemplate")
        btn:SetSize(300, 35)
        btn:SetPoint("TOP", 0, res.y)
        btn:SetText(res.name)
        btn.resKey = res.key
        
        -- Create selection highlight
        btn.highlight = btn:CreateTexture(nil, "BACKGROUND")
        btn.highlight:SetPoint("TOPLEFT", btn, "TOPLEFT", -4, 4)
        btn.highlight:SetPoint("BOTTOMRIGHT", btn, "BOTTOMRIGHT", 4, -4)
        btn.highlight:SetColorTexture(0, 1, 0, 0.6)
        btn.highlight:Hide()
        
        btn:SetScript("OnClick", function(self)
            frame.selectedResolution = self.resKey
            -- Update button states
            for _, b in ipairs(step1.resButtons) do
                if b == self then
                    b.highlight:Show()
                else
                    b.highlight:Hide()
                end
            end
        end)
        table.insert(step1.resButtons, btn)
    end
    
    frame.step1 = step1
end

function Setup:CreateStep2(frame)
    local step2 = CreateFrame("Frame", nil, frame.content)
    step2:SetAllPoints()
    step2:Hide()
    
    local titleText = step2:CreateFontString(nil, "OVERLAY", "GameFontNormalLarge")
    titleText:SetPoint("TOP", 0, -20)
    titleText:SetText("Ready to Configure")
    titleText:SetTextColor(0, 1, 0)
    
    step2.infoText = step2:CreateFontString(nil, "OVERLAY", "GameFontNormal")
    step2.infoText:SetPoint("TOP", titleText, "BOTTOM", 0, -20)
    step2.infoText:SetWidth(550)
    step2.infoText:SetJustifyH("LEFT")
    
    local detailsText = step2:CreateFontString(nil, "OVERLAY", "GameFontNormal")
    detailsText:SetPoint("TOP", step2.infoText, "BOTTOM", 0, -30)
    detailsText:SetWidth(550)
    detailsText:SetJustifyH("LEFT")
    detailsText:SetText("The following will be configured:\n\n• WoW Edit Mode layout optimized for your resolution\n• MidnightUI bar positions and scaling\n• Unit frame positions\n\nClick 'Finish' to apply the configuration.\n\n|cffff0000Note: This will reload your UI.|r")
    
    frame.step2 = step2
end

function Setup:GoToStep(frame, step)
    frame.currentStep = step
    
    -- Hide all steps
    frame.step1:Hide()
    frame.step2:Hide()
    
    -- Show current step
    if step == 1 then
        frame.step1:Show()
        frame.backButton:Hide()
        frame.nextButton:SetText("Next")
        frame.nextButton:Enable()
    elseif step == 2 then
        frame.step2:Show()
        frame.backButton:Show()
        frame.nextButton:SetText("Finish")
        
        -- Update confirmation text
        local resName = frame.selectedResolution == "4K" and "4K (3840 x 2160)" or 
                       frame.selectedResolution == "1440p" and "1440p (2560 x 1440)" or 
                       "1080p (1920 x 1080)"
        frame.step2.infoText:SetText("You have selected: |cff00ff00" .. resName .. "|r")
    end
end

function Setup:CompleteSetup(frame)
    local res = frame.selectedResolution
    if not res then return end
    
    -- Check if 4K is selected (not yet supported)
    if res == "4K" then
        print("|cffff0000MidnightUI:|r 4K presets are not available yet. Please choose 1440p or 1080p.")
        return
    end
    
    print("MidnightUI: Applying " .. res .. " configuration...")
    
    -- Import Edit Mode preset
    if editModePresets[res] and editModePresets[res] ~= "YOUR_" .. res:upper():gsub("P", "") .. "_EDIT_MODE_STRING_HERE" then
        local success = pcall(function()
            C_EditMode.SetLayouts(C_EditMode.ConvertStringToLayoutInfo(editModePresets[res]))
        end)
        if success then
            print("MidnightUI: Edit Mode layout imported successfully")
        else
            print("MidnightUI: Failed to import Edit Mode layout")
        end
    else
        print("MidnightUI: No Edit Mode preset configured for " .. res)
    end
    
    -- Import MidnightUI preset
    if midnightUIPresets[res] and midnightUIPresets[res] ~= "YOUR_" .. res:upper():gsub("P", "") .. "_MIDNIGHTUI_STRING_HERE" then
        -- Use the DoImport function from Core to apply the preset
        local success = pcall(function()
            MidnightUI:DoImport(midnightUIPresets[res], nil)
        end)
        if success then
            print("MidnightUI: Profile preset imported successfully")
        else
            print("MidnightUI: Failed to import profile preset")
        end
    else
        print("MidnightUI: No MidnightUI preset configured for " .. res)
    end
    
    -- Mark setup as complete
    self.db.profile.hasCompletedSetup = true
    frame:Hide()
    
    -- Reload UI
    C_Timer.After(1, function()
        print("MidnightUI: Setup complete! Reloading UI...")
        C_Timer.After(1, function()
            ReloadUI()
        end)
    end)
end

function Setup:GetOptions()
    return {
        type = "group",
        name = "Setup Wizard",
        args = {
            runSetup = {
                name = "Run Setup Wizard",
                desc = "Run the first-time setup wizard again",
                type = "execute",
                order = 1,
                func = function()
                    self:ShowSetupWizard()
                end
            },
            resetSetup = {
                name = "Reset Setup Status",
                desc = "Mark setup as not completed so it runs again on next login",
                type = "execute",
                order = 2,
                func = function()
                    self.db.profile.hasCompletedSetup = false
                    print("MidnightUI: Setup status reset. The wizard will appear on next login.")
                end
            },
            editPresets = {
                name = "Edit Preset Strings",
                type = "group",
                inline = true,
                order = 3,
                args = {
                    info = {
                        name = "To configure preset strings, edit the Setup.lua file and replace the placeholder strings with your actual export strings.",
                        type = "description",
                        order = 1,
                    }
                }
            }
        }
    }
end

return Setup
